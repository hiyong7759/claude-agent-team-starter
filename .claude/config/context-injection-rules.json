{
  "version": "3.0",
  "_description": "Rule definitions for dynamic context injection. v3.0: se→fe/be split, cr absorbed into qa. FE gets frontend rules only, BE gets backend rules only, QA gets both for cross-cutting review.",

  "tier_defaults": {
    "_comment": "Path pattern to default tier mapping (0=Always, 1=Agent-specific, 2=Conditional)",

    "docs/rules/hard-rules.md": 0,
    "docs/rules/output-contracts.md": 0,
    "docs/rules/glossary.md": 1,
    "docs/rules/*.md": 1,
    "docs/templates/*": 2,
    "docs/registry/*": 2,
    "docs/adr/*": 1
  },

  "category_agent_mapping": {
    "_comment": "Document category to agent groups mapping. '*' means all agents. v3.0: se→fe/be, cr→qa.",

    "rules": ["*"],
    "templates": ["fe", "be", "sa", "docops", "uv", "ps"],
    "registry": ["eo", "docops", "sa"],
    "adr": ["sa", "fe", "be", "eo", "qa"],
    "deliverables": ["fe", "be", "re", "qa", "eo"]
  },

  "agent_required_tiers": {
    "_comment": "Agent to required tier levels mapping. v3.0: qa gets [0,1] (absorbed cr's review depth).",

    "ps": [0],
    "eo": [0, 1],
    "sa": [0, 1],
    "fe": [0],
    "be": [0],
    "re": [0],
    "pg": [0, 1],
    "tr": [0],
    "uv": [0],
    "docops": [0, 1],
    "qa": [0, 1]
  },

  "task_type_documents": {
    "_comment": "Two-phase document injection with union merge.",

    "matching_strategy": {
      "phase_1": "keyword_contains",
      "phase_2": "llm_inference",
      "execution": "parallel_always",
      "merge_strategy": "union_dedupe",
      "_description": "Both phases always execute. Phase 1 provides deterministic baseline via keyword matching. Phase 2 LLM analyzes WI content semantically to catch what keywords miss. Final result = union of both with duplicates removed."
    },

    "types": [
      {
        "id": "ui-ux",
        "description": "UI/UX design, components, styling, layout tasks",
        "keywords": ["UI", "UX", "component", "style", "layout", "color", "typography", "font", "responsive", "design system", "DDS", "KRDS"],
        "documents": ["projects/agent-dds/docs/guide/dds_design_strategy.md"],
        "tier": 2,
        "_note": "UI/UX guidelines in DDS project. uv and fe reference these for design tasks."
      },
      {
        "id": "testing-qa",
        "description": "Testing, validation, quality assurance, evaluation tasks",
        "keywords": ["test", "validation", "QA", "quality", "regression", "E2E", "evaluation", "golden"],
        "documents": ["docs/rules/test-rules.md", "docs/rules/quality-gates-rules.md"],
        "tier": 1
      },
      {
        "id": "security",
        "description": "Security, authentication, authorization, privacy tasks",
        "keywords": ["security", "auth", "authentication", "login", "PII", "privacy", "permission", "access control", "password", "token", "secret", "credential"],
        "documents": ["docs/rules/security-rules.md"],
        "tier": 1
      },
      {
        "id": "architecture",
        "description": "System architecture, ADR, structural decisions",
        "keywords": ["architecture", "ADR", "system design", "structure", "module", "dependency", "orchestration"],
        "documents": ["docs/rules/workflow-rules.md", "docs/adr/*"],
        "tier": 1
      },
      {
        "id": "workflow",
        "description": "Development workflow, process, operation tasks",
        "keywords": ["workflow", "process", "operation", "procedure", "REQ", "WI", "handoff"],
        "documents": ["docs/rules/workflow-rules.md", "docs/rules/hard-rules.md"],
        "tier": 1
      },
      {
        "id": "documentation",
        "description": "Documentation, glossary, terminology tasks",
        "keywords": ["document", "documentation", "translation", "glossary", "terminology"],
        "documents": ["docs/rules/glossary.md", "docs/rules/doc-rules.md"],
        "tier": [0, 1]
      },
      {
        "id": "onboarding",
        "description": "Project onboarding, setup, initialization tasks",
        "keywords": ["onboarding", "setup", "init", "project creation", "configuration"],
        "documents": ["docs/rules/workflow-rules.md"],
        "tier": 1
      },
      {
        "id": "review",
        "description": "Code review, best practice verification tasks",
        "keywords": ["review", "code review", "best practice", "peer review"],
        "documents": ["docs/rules/review-rules.md", "docs/rules/naming-rules.md"],
        "tier": 1
      },
      {
        "id": "team-coordination",
        "description": "Agent team coordination, spawn, feedback loop tasks",
        "keywords": ["team", "spawn", "impl-team", "coordination", "feedback loop", "team mode"],
        "documents": [".claude/config/team-definitions.json", ".claude/skills/spawn-impl-team/SKILL.md"],
        "tier": 2,
        "_note": "Team mode coordination documents."
      }
    ],

    "llm_inference_config": {
      "_comment": "Phase 2: LLM semantic analysis runs alongside Phase 1 keyword matching.",
      "search_scope": ["docs/rules/*", "docs/adr/*", "docs/templates/*"],
      "exclude_from_inference": ["docs/registry/*"],
      "max_additional_docs": 5,
      "instruction": "Analyze the WI content semantically. Identify relevant rule modules from docs/rules/ based on task context. Return document paths that would help the assignee complete the task."
    }
  },

  "priority_rules": {
    "_comment": "Priority and conflict resolution rules.",

    "tier_precedence": "metadata_first",
    "conflict_resolution": "lowest_tier_wins",
    "max_documents_per_tier": {
      "0": 10,
      "1": 15,
      "2": 20,
      "3": 10
    }
  },

  "agent_specific_requirements": {
    "_comment": "Explicit document requirements per agent. v3.0: se→fe/be, cr→qa. FE=frontend only, BE=backend only, QA=full-stack.",

    "ps": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md"]
    },
    "eo": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/execution-rules.md"]
    },
    "sa": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md"]
    },
    "fe": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/naming-rules.md"],
      "conditional": {
        "react": [".claude/skills/react-best-practices/AGENTS.md"]
      }
    },
    "be": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/naming-rules.md"],
      "conditional": {
        "typescript": ["docs/rules/ts-impl-rules.md"],
        "python": ["docs/rules/python-rules.md"]
      }
    },
    "re": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/test-rules.md", "docs/rules/quality-gates-rules.md"]
    },
    "pg": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/security-rules.md", "docs/rules/execution-rules.md"]
    },
    "tr": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md"]
    },
    "uv": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/naming-rules.md"],
      "conditional": {
        "react": [".claude/skills/react-best-practices/AGENTS.md"]
      }
    },
    "docops": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/doc-rules.md", "docs/rules/glossary.md"]
    },
    "qa": {
      "required": ["docs/rules/hard-rules.md", "docs/rules/output-contracts.md", "docs/rules/test-rules.md", "docs/rules/quality-gates-rules.md", "docs/rules/review-rules.md", "docs/rules/naming-rules.md", "docs/rules/security-rules.md"],
      "conditional": {
        "react": [".claude/skills/react-best-practices/AGENTS.md"],
        "typescript": ["docs/rules/ts-impl-rules.md"],
        "python": ["docs/rules/python-rules.md"]
      }
    }
  },

  "tech_stack_documents": {
    "_comment": "Tech-stack-based conditional injection. v3.0: fe gets react only, be gets ts/python only, qa gets both.",

    "react": {
      "documents": [".claude/skills/react-best-practices/AGENTS.md"],
      "applicable_agents": ["fe", "qa", "uv"],
      "tier": 2,
      "note": "React/Next.js performance optimization guidelines. FE and QA only (not BE)."
    },
    "react-native": {
      "documents": [".claude/skills/react-best-practices/AGENTS.md"],
      "applicable_agents": ["fe", "qa", "uv"],
      "tier": 2,
      "note": "React Native shares React best practices."
    }
  }
}
